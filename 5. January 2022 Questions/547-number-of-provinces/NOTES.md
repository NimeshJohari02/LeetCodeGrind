We use DSU . One approach is also to construct the graph then perform bfs / dfs . I have implemented class DSU . Note
j = i+1 start to avoid self loops
also
change definition of dsu to incorporate 0 . As the naming of nodes is unneccessary/ redundant we can consider first node as 0 .